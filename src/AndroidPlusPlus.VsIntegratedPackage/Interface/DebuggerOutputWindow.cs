////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Text;

using Microsoft.VisualStudio;
using Microsoft.VisualStudio.Shell;
using Microsoft.VisualStudio.Shell.Interop;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

namespace AndroidPlusPlus.VsIntegratedPackage
{

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  public class DebuggerOutputWindow
  {

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public static void WriteLine (Guid outputPaneGuid, string line)
    {
      // 
      // Output specified line to the pane represented by the provided Guid.
      //   i.e. VSConstants.OutputWindowPaneGuid.DebugPane_guid
      // 

      IVsOutputWindowPane debugWindowPane;

      IVsOutputWindow outputWindow = Package.GetGlobalService (typeof (SVsOutputWindow)) as IVsOutputWindow;

      if (outputWindow.GetPane (outputPaneGuid, out debugWindowPane) != VSConstants.S_OK)
      {
        ErrorHandler.ThrowOnFailure (outputWindow.CreatePane (outputPaneGuid, "General", 1, 0));

        ErrorHandler.ThrowOnFailure (outputWindow.GetPane (outputPaneGuid, out debugWindowPane));
      }

      ErrorHandler.ThrowOnFailure (debugWindowPane.Activate ());

      ErrorHandler.ThrowOnFailure (debugWindowPane.OutputString (line + Environment.NewLine));
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  }

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
